<!DOCTYPE html>
<html>


<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="css/materialize.min.css" />
    <link rel="stylesheet" href="css/fontawesome/all.css" />
   
</head>

<style>
#wrapper {
  width: 100%;
  height: 400px;
  display: flex;
  align-items: center;
  justify-content: center;
}

</style>
  

<body>
  <div id="wrapper" style="display: none;">
    <div class="card-panel">
        <span id="errorContent" class="blue-text text-darken-2"></span>
        <button class=" waves-effect waves-light btn button" id="retry" onclick="javascript:window.location.href='index.html';">Retry</button>
    </div>
  </div>
</body>

<script>
var  errorConent;
var reloadDiv   =   document.getElementById('wrapper');
errorConent     =   document.getElementById('errorContent');
getLocation();
    
/**
 * Getting the user location
 * This page use as a contraint for app 
 *  - User need to give permission inorder to process to application
*/
function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition, showError);
        } else { 
            x.innerHTML = "Geolocation is not supported by this browser.";
        }
}


function showPosition(position) {

  realtimeLatitude   =   position.coords.latitude;
  realtimeLongitude  =   position.coords.longitude; 
  realtimeAltitude   =   position.coords.altitude;

   // Reduce the sensitivit of the cordinates

   realtimeLatitude = realtimeLatitude * 1000;
   realtimeLatitude =  realtimeLatitude.toFixed(2);
   realtimeLatitude = realtimeLatitude/1000;
   realtimeLatitude = realtimeLatitude.toFixed(2);
   
   realtimeLongitude = realtimeLongitude * 1000;
   realtimeLongitude = realtimeLongitude.toFixed(2);
   realtimeLongitude = realtimeLongitude/1000;
   realtimeLongitude = realtimeLongitude.toFixed(2);

   localStorage.setItem('userLatitude', realtimeLatitude);
   localStorage.setItem('userLongitude', realtimeLongitude);
   localStorage.setItem('userAltitude', realtimeAltitude);
   localStorage.setItem('imageLatitude', localStorage.getItem('userLatitude'));
   localStorage.setItem('imageLongitude', localStorage.getItem('userLongitude'));
 
   window.location = "canopeo.html";
}

function showError(error) {
  reloadDiv.style.display="flex";
  switch(error.code) {
    case error.PERMISSION_DENIED:
      errorConent.innerHTML = "<b>Location Service Required.</b><br><text>Sorry, the app requires the location of the user. you must allow the location to be active during the usage of app .<text></br></br>";
      //alert("You need to allow geo-location for the app to wor  k. Please click on retry");
      break;
    case error.POSITION_UNAVAILABLE:
      errorConent.innerHTML = "Location information is unavailable."
      break;
    case error.TIMEOUT:
      errorConent.innerHTML = "The request to get user location timed out."
      break;
    case error.UNKNOWN_ERROR:
      errorConent.innerHTML = "An unknown error occurred."
      break;
  }
}



    
</script>




</html>
