<!DOCTYPE html>
<html>


<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

   
</head>


<body>
    <div id="retryDic">
        <i class="fas fa-frown"></i>
        <button class="button" id="retry" style="display: none;" onclick="javascript:window.location.href='';">Retry</button>
    </div>
</body>

<script>


var retryButton = document.getElementById("retry");
getLocation();
    
/**
 * Getting the user location
 * This page use as a contraint for app 
 *  - User need to give permission inorder to process to application
*/
function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition, showError);
        } else { 
            x.innerHTML = "Geolocation is not supported by this browser.";
        }
}

function showPosition(position) {

  realtimeLatitude   =   position.coords.latitude;
  realtimeLongitude  =   position.coords.longitude; 
  realtimeAltitude   =   position.coords.altitude;

   // Reduce the sensitivit of the cordinates

   realtimeLatitude = realtimeLatitude * 1000
   realtimeLatitude = realtimeLatitude.toFixed(2);
   realtimeLatitude = realtimeLatitude/1000;
   realtimeLatitude = realtimeLatitude.toFixed(2);
   
   realtimeLongitude = realtimeLongitude * 1000
   realtimeLongitude = realtimeLongitude.toFixed(2);
   realtimeLongitude = realtimeLongitude/1000;
   realtimeLongitude = realtimeLongitude.toFixed(2);

   localStorage.setItem('userLatitude', realtimeLatitude);
   localStorage.setItem('userLongitude', realtimeLongitude);
   localStorage.setItem('userAltitude', realtimeAltitude);
   localStorage.setItem('imageLatitude', localStorage.getItem('userLatitude'));
   localStorage.setItem('imageLongitude', localStorage.getItem('userLongitude'));
 

   window.location = "canopeo.html";

}

function showError(error) {
  switch(error.code) {
    case error.PERMISSION_DENIED:
      //x.innerHTML = "User denied the request for Geolocation.
      retryButton.style.display="block";
      alert("User denied permission for geolocation. Please click on retry");
      break;
    case error.POSITION_UNAVAILABLE:
      x.innerHTML = "Location information is unavailable."
      break;
    case error.TIMEOUT:
      x.innerHTML = "The request to get user location timed out."
      break;
    case error.UNKNOWN_ERROR:
      x.innerHTML = "An unknown error occurred."
      break;
  }
}



    
</script>




</html>